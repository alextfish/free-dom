<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="content-type" content="text/html;charset=UTF-8" />
    <title><%= @full_title ? h(@full_title) : ("Dominion - " + h(@title)) -%></title>
    <%= stylesheet_link_tag 'scaffold', 'common', 'game'%>
    <link rel="stylesheet/less", type="text/css" href="/stylesheets/common2.less">
    <link rel="stylesheet/less", type="text/css" href="/stylesheets/game2.less">
    <%= javascript_include_tag "less" %>
    <link rel="icon" type="image/vnd.microsoft.icon" href='<%= image_path("/favicon.ico") %>' />
    <%= javascript_include_tag :defaults %>
    <%= javascript_include_tag "modernizr.freedom" %>
		<%= javascript_include_tag "card_dict" %>
    
    <script type='text/javascript'>
      function disable_named(name){
          var arr = new Array();
          arr = document.getElementsByName(name);
          for (var i = 0; i < arr.length; i++) {
              arr[i].disabled = true;
          }
      }
						
			/*
			  Copyright Robert Nyman, http://www.robertnyman.com
			  Free to use if this text is included
			*/
			function getElementsByAttribute(oElm, strTagName, strAttributeName, strAttributeValue){
			  var arrElements = (strTagName == "*" && oElm.all)? oElm.all : oElm.getElementsByTagName(strTagName);
			  var arrReturnElements = new Array();
			  var oAttributeValue = (typeof strAttributeValue != "undefined")? new RegExp("(^|\\s)" + strAttributeValue + "(\\s|$)") : null;
			  var oCurrent;
			  var oAttribute;
			  for(var i=0; i<arrElements.length; i++){
			    oCurrent = arrElements[i];
			    oAttribute = oCurrent.getAttribute && oCurrent.getAttribute(strAttributeName);
			    if(typeof oAttribute == "string" && oAttribute.length > 0){
			      if(typeof strAttributeValue == "undefined" || (oAttributeValue && oAttributeValue.test(oAttribute))){
			        arrReturnElements.push(oCurrent);
			      }
			    }
			  }
			  return arrReturnElements;
			}

      function onloadFunc() {
				// Scroll to bottom of history
				var histDiv=document.getElementById('history'); 
				if (histDiv) {
			    histDiv.scrollTop = histDiv.scrollHeight;
		    }
				
				// Scroll to bottom of chat
				$('chatbox').scrollTop = $('chatbox').scrollHeight;
				
			  // Enable all buttons
				var buttons = getElementsByAttribute(document.body, "input", "type", "button")
				buttons = buttons.concat(getElementsByAttribute(document.body, "input", "type", "submit"))
				for (var i = 0; i < buttons.length; i++) {
          buttons[i].disabled = false;
        }
			}
    </script>
  </head>
  <body onload="onloadFunc();">

  <% link_to(games_path, :id => "siteLogo") do %>
    <h1>FreeDom</h1>
    <h2>Free Dominion Game Server</h2>
  <% end %>
		
    <div id="userInfo">
      <% if session[:user_id].nil? %>
        Welcome, Guest. Please <%= link_to "login", login_path -%> or <%= link_to "register", new_user_path -%>
			<% else %>
			  <% user = User.find(session[:user_id]) %>
			  Welcome, <%= user.name -%> | <%= link_to "Preferences", settings_path -%> | Not <%= user.name-%>? Please <%= link_to "logout", logout_path -%> 
      <% end %>
    </div>
		
    <div id="mainContent">
    	<div id="flash">
    		<%= render :partial => 'flash_area' -%>
    	</div>
      <%= yield %>
    </div>
		
		<div id="footer">
		  <%= link_to "Home", games_path %> | <%= link_to "About", about_path%> | <%= link_to "Feedback", contact_path %> 
		</div>
  </body>
</html>
